<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>React Tutorial</title>


<link rel="stylesheet" type="text/css" href="/node_modules/bootstrap/dist/css/bootstrap.css" >

<style>

.cell{
    background-color: #F4F6F3;
    padding:20px;
    border: black;
    border-style: solid;
    height:200px;
}

.centerimg{
    width:auto;
    height:100%;
    margin:auto;
      position:absolute;
      left:25%;
      top:10%;
      bottom:10%;
  -webkit-transition: opacity 1s ease-in-out;
  -moz-transition: opacity 1s ease-in-out;
  -o-transition: opacity 1s ease-in-out;
  transition: opacity 1s ease-in-out;
}

.headercell{
    background-color: #7499A6;
    min-height: 100px;
    width:100%;
    padding:10px;
}

body{
    background-color: #30A9D1 ;
}

.container{
    background-color:   #F4F6F3;
    margin-top: 30px;
}

.invisible {
    opacity: 0;
}

</style>



    <script src="/node_modules/react/dist/react.js"></script>
    <script src="/node_modules/react-dom/dist/react-dom.js"></script>
    <script src="/node_modules/babel-standalone/babel.min.js"></script>
    <script src="https://unpkg.com/jquery@3.1.0/dist/jquery.min.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.js"></script>
    <script src="https://unpkg.com/remarkable@1.7.1/dist/remarkable.min.js"></script>

  </head>
  <body>
    <div class="container" id="content"></div>
    <script type="text/babel">


var Game = React.createClass({
    getInitialState: function() {
        return {
            status: " ",
            turn: 0,
            clicks: 0,
            tiles : [
                { number: 0 , status : "N" },
                { number: 1 , status: "N" },
                { number: 2 , status: "N" },
                { number: 3 , status: "N" },
                { number: 4 , status: "N" },
                { number: 5 , status: "N" },
                { number: 6 , status: "N" },
                { number: 7 , status: "N" },
                { number: 8 , status: "N" }
            ]
        };
    },
    checkOnClick : function( number){
                console.log(number);
                var dumb = this.state.tiles;
                dumb[number].status =  ( (this.state.turn==0) ? "X" : "O" ) ;
                this.setState({
                    clicks: this.state.clicks+1 ,
                    turn : ( (this.state.turn==0) ? 1 : 0 ) ,
                    tiles : dumb
                } , this.checkWin() );



    },

    alertWin : function(winner){
        alert("o nikitis ine o "+winner+" se "+this.state.clicks+" girous");
    },

    checkWin : function () {
        if ( ( this.state.tiles[0].status == this.state.tiles[1].status && this.state.tiles[0].status  == this.state.tiles[2].status ) && ( this.state.tiles[0].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[3].status == this.state.tiles[4].status && this.state.tiles[3].status  == this.state.tiles[5].status ) && ( this.state.tiles[3].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[6].status == this.state.tiles[7].status && this.state.tiles[6].status  == this.state.tiles[8].status ) && ( this.state.tiles[6].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[0].status == this.state.tiles[4].status && this.state.tiles[0].status  == this.state.tiles[8].status ) && ( this.state.tiles[0].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[2].status == this.state.tiles[4].status && this.state.tiles[2].status  == this.state.tiles[6].status ) && ( this.state.tiles[2].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[0].status == this.state.tiles[3].status && this.state.tiles[0].status  == this.state.tiles[6].status ) && ( this.state.tiles[0].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[1].status == this.state.tiles[4].status && this.state.tiles[1].status  == this.state.tiles[7].status ) && ( this.state.tiles[1].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }else        if ( ( this.state.tiles[2].status == this.state.tiles[5].status && this.state.tiles[2].status  == this.state.tiles[8].status ) && ( this.state.tiles[2].status != "N" ) ){
            if ( this.state.tiles[0].status =="O" ){
                this.alertWin("player 2");
            }else{
                this.alertWin("player 1");
            }
        }

    },

    render: function() {
            var parentState = this.state;
            return (
                <div>
                    <div className="row"><InfoBox  parentState={parentState} />
                        {this.state.tiles.map((tile) => {
                         return (
                           <TileBox
                             data={tile} parentState={parentState}
                             onSelect={this.checkOnClick}

                           />
                         );
                        })}
                    </div>
                </div>
            );
    }

});



var TileBox = React.createClass({

  getInitialState: function() {
    return {  status : "N"  , imgpath : "img/clear.png"  };
  },

    handleClick: function() {
        if (this.props.data.status == "N"){
            this.props.onSelect(this.props.data.number);
            if ( this.props.parentState.turn == 0 ){
                this.setState({
                    imgpath : "img/x.png"
                });
            }else{
                this.setState({
                    imgpath : "img/o.png"
                });
            }
        }
    },
    getClasses : function(status){
        return "centerimg img-responsive "+ (( status == this.props.data.status) ? "" : "invisible" ) ;
    },

  render: function() {
    return (
        <div  onClick={this.handleClick}  className="col-md-4 cell ">
            <img className={this.getClasses("N")} src="img/clear.png" />
            <img className={this.getClasses("O")} src="img/o.png" />
            <img className={this.getClasses("X")} src="img/x.png" />
        </div>
    );
  }
});


var InfoBox = React.createClass({

  getInitialState: function() {
    return { players : ["Player 1" , "Player 2"]    };
  },
  printPlayer : function(){
    console.log("test");
    console.log(this.state.players[this.props.parentState.turn]);
    console.log("test");

    return this.state.players[this.props.parentState.turn];
  },

  printTurn : function(){
    return this.props.parentState.turn;
  },

  render: function() {
    console.log(this.props.parentState);
    return (
        <div className="col-md-12 headercell ">

            <div className="panel panel-default">
              <div className="panel-body">
                <h1>Tic - Tac - Toe</h1>
              </div>
            </div>
            <div className="col-md-6">
                <div className="well">
                    <h2>
                        <span className="label label-default" ><span className="glyphicon glyphicon glyphicon-user" aria-hidden="true"></span>  Turn to Play :</span>
                        <span style={{float:"right"}} className="label label-default">{ this.state.players[this.props.parentState.turn]  }</span>
                    </h2>
                </div>
            </div>
            <div className="col-md-6">
                <div className="well">
                    <h2>
                        <span className="label label-default"><span className="glyphicon glyphicon glyphicon-play" aria-hidden="true"></span>  Turns Played :</span>
                        <span style={{float:"right"}} className="label label-default">{  this.props.parentState.clicks  }</span>
                    </h2>
                </div>
            </div>
        </div>
    );
  }
});







ReactDOM.render(
  <Game ></Game>,
  document.getElementById('content')
);



    </script>
  </body>
</html>